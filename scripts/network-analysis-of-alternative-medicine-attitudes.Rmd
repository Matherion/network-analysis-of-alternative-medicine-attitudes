---
title: "Network analysis of alternative medicine attitudes"
author: "Szilvia Zörgő, Samvel Mkhitaryan & Gjalt-Jorn Peters"
date: "February 6, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Analyses

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE);

if (!'ufs' %in% row.names(installed.packages())) install.packages('ufs');
require('haven');
ufs::safeRequire('haven');
ufs::safeRequire('here');
ufs::safeRequire('pander');
ufs::safeRequire('GGally');
ufs::safeRequire('userfriendlyscience');

dataPath <-
  here::here('data');

```

## Loading and preparing data

```{r import-data}

### Import using haven
dat <-
  haven::read_sav(file.path(dataPath,
                            'database.orig.new labels.sav'));

### ... But convert to a data frame instead of a tibble, because,
### for example, length(unique(dat[, 'group'])) results in 1 instead
### of 2...
dat <- as.data.frame(dat);

### Set group as factor
dat$group <-
  factor(dat$group,
         levels=1:2,
         labels=c("Alternative medicine",
                  "Medicine"));

### Extract and store attitude variable names
attitudeVars <-
  grep('ATT1_',
       names(dat),
       value=TRUE);

```

## Descriptives

```{r descriptives, fig.height=20}

ufs::cat0("\n\n### Group\n\n");
pander(userfriendlyscience::freq(dat$group));

ufs::cat0("\n\n### Attitude\n\n");

ufs::meansComparisonDiamondPlot(dat,
                                rev(attitudeVars),
                                compareBy = 'group');

```

## Correlations

```{r correlations, fig.width=16, fig.height=16}

### Takes way too long, huge, etc
# GGally::ggpairs(dat[, attitudeVars]);

cors <- cor(dat[, attitudeVars]);

knitr::kable(cors);

### http://www.sthda.com/english/wiki/ggcorrplot-visualization-of-a-correlation-matrix-using-ggplot2
                
ggcorrplot::ggcorrplot(cors);

ggcorrplot::ggcorrplot(cors,
                       method = "circle");

ggcorrplot::ggcorrplot(cors,
                       lab = TRUE);

```




